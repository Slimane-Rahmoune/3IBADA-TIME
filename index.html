<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø¬Ø¯ÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª</title>
  <style>
    :root{--bg:#eef6ff;--card:#fff;--text:#1b2a41;--muted:#5f6b7a;--shadow:0 1px 4px rgba(0,0,0,.12);}
    html,body{height:100%}
    body{margin:14px;background:var(--bg);font-family:Tahoma,Arial,sans-serif;color:var(--text)}
    .wrap{max-width:820px;margin:0 auto}
    header{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;margin-bottom:12px}
    h1{font-size:20px;margin:0}
    .row{display:flex;gap:10px;align-items:center}
    select,button{border:1px solid #cfd8e3;background:#fff;border-radius:8px;padding:8px 10px;cursor:pointer}
    .primary{background:#1e88e5;color:#fff;border:none}
    .card{background:var(--card);box-shadow:var(--shadow);border-radius:12px;padding:12px;margin:12px 0}
    .task{display:flex;align-items:center;justify-content:space-between;padding:10px;border-bottom:1px solid #f0f0f0}
    .task:last-child{border-bottom:none}
    .left{display:flex;gap:10px;align-items:center}
    .time{font-weight:bold;min-width:130px}
    .done{text-decoration:line-through;color:#777}
    .muted{color:var(--muted);font-size:12px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
    .status{min-height:18px;margin-top:6px}
    @media (max-width:520px){.time{min-width:auto}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 id="title">ğŸ•°ï¸ Ø¬Ø¯ÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª Ø¹Ù„Ù‰ Ù…Ù†Ù‡Ø¬ Ø§Ù„Ù†Ø¨ÙŠ ï·º</h1>
      <div class="row">
        <label for="lang" id="langLabel">Ø§Ù„Ù„ØºØ©:</label>
        <select id="lang">
          <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
          <option value="fr">FranÃ§ais</option>
          <option value="en">English</option>
        </select>
        <button id="notifyBtn" class="primary">ğŸ”” ÙØ¹Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</button>
      </div>
    </header>

    <div class="card">
      <div class="toolbar">
        <button id="checkAll" class="primary">âœ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„</button>
        <button id="uncheckAll">â†©ï¸ Ø¥Ù„ØºØ§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„</button>
        <button id="resetDay">ğŸ—“ï¸ ØªØµÙÙŠØ± Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…</button>
      </div>
      <div id="tasks"></div>
      <div id="progress" class="status muted"></div>
    </div>

    <p class="muted" id="hint">
      Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØªÙ… Ø­ÙØ¸ Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙŠÙˆÙ…ÙŠÙ‹Ø§. ØªØºÙŠÙ‘Ø± Ø§Ù„Ù„ØºØ© ÙŠØºÙŠÙ‘Ø± Ø£ÙŠØ¶Ù‹Ø§ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø© ÙˆÙ†ØµÙˆØµ Ø§Ù„Ù…Ù‡Ø§Ù….
    </p>
  </div>

  <script>
    // ======= i18n strings =======
    const T = {
      ar:{
        title:"ğŸ•°ï¸ Ø¬Ø¯ÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª Ø¹Ù„Ù‰ Ù…Ù†Ù‡Ø¬ Ø§Ù„Ù†Ø¨ÙŠ ï·º",
        lang:"Ø§Ù„Ù„ØºØ©:",
        notify:"ğŸ”” ÙØ¹Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
        checkAll:"âœ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„",
        uncheckAll:"â†©ï¸ Ø¥Ù„ØºØ§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„",
        resetDay:"ğŸ—“ï¸ ØªØµÙÙŠØ± Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…",
        hint:"Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØªÙ… Ø­ÙØ¸ Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙŠÙˆÙ…ÙŠÙ‹Ø§. ØªØºÙŠÙ‘Ø± Ø§Ù„Ù„ØºØ© ÙŠØºÙŠÙ‘Ø± Ø£ÙŠØ¶Ù‹Ø§ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø© ÙˆÙ†ØµÙˆØµ Ø§Ù„Ù…Ù‡Ø§Ù….",
        notified:"âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
        noNotif:"ğŸš« Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
        tasks:[
          {time:"Ù‚Ø¨Ù„ Ø§Ù„ÙØ¬Ø±", action:"Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„ ÙˆØ°ÙƒØ± Ø§Ù„Ù„Ù‡"},
          {time:"Ø§Ù„ÙØ¬Ø± â€“ Ø§Ù„Ø´Ø±ÙˆÙ‚", action:"ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø± + Ø°ÙƒØ± ÙˆÙ‚Ø±Ø¢Ù†"},
          {time:"Ø§Ù„ØµØ¨Ø§Ø­", action:"Ø¹Ù…Ù„/Ø¯Ø±Ø§Ø³Ø© Ø¨Ù†ÙŠÙ‘Ø© Ù„Ù„Ù‡"},
          {time:"Ø§Ù„Ø¶Ø­Ù‰", action:"Ø±ÙƒØ¹ØªØ§Ù† Ø£Ùˆ Ø£Ø±Ø¨Ø¹"},
          {time:"Ø§Ù„Ø¸Ù‡Ø±", action:"ØµÙ„Ø§Ø© + Ù‚ÙŠÙ„ÙˆÙ„Ø©"},
          {time:"Ø§Ù„Ø¹ØµØ± â€“ Ø§Ù„Ù…ØºØ±Ø¨", action:"Ø¹Ù…Ù„/Ø¹Ù„Ù… + Ø±ÙŠØ§Ø¶Ø©"},
          {time:"Ø§Ù„Ù…ØºØ±Ø¨ â€“ Ø§Ù„Ø¹Ø´Ø§Ø¡", action:"Ø¬Ù„Ø³Ø© Ø¹Ø§Ø¦Ù„ÙŠØ© + Ù‚Ø±Ø¢Ù†"},
          {time:"Ø§Ù„Ø¹Ø´Ø§Ø¡", action:"ØµÙ„Ø§Ø© + Ø±Ø§Ø­Ø©/Ù…Ø·Ø§Ù„Ø¹Ø©"},
          {time:"Ø§Ù„Ù„ÙŠÙ„", action:"Ù†ÙˆÙ… Ù…Ø¨ÙƒØ± + Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„"}
        ],
        progress:(done,total)=>`Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ…: ${done}/${total} (${Math.round(done*100/total)}%)`
      },
      fr:{
        title:"ğŸ•°ï¸ Planning dâ€™adorations â€“ MÃ©thode du ProphÃ¨te ï·º",
        lang:"Langue :",
        notify:"ğŸ”” Activer les notifications",
        checkAll:"âœ… Tout cocher",
        uncheckAll:"â†©ï¸ Tout dÃ©cocher",
        resetDay:"ğŸ—“ï¸ RÃ©initialiser la journÃ©e",
        hint:"Astuce : votre progression est enregistrÃ©e localement par jour. Changer de langue adapte aussi lâ€™orientation et les textes.",
        notified:"âœ… Notifications activÃ©es",
        noNotif:"ğŸš« Votre navigateur ne supporte pas les notifications",
        tasks:[
          {time:"Avant lâ€™aube", action:"QiyÃ¢m et rappel dâ€™Allah"},
          {time:"Fajr â€“ Lever du soleil", action:"PriÃ¨re du Fajr + Coran & invocations"},
          {time:"Matin", action:"Travail/Ã©tudes avec intention sincÃ¨re"},
          {time:"Duha", action:"2 Ã  4 unitÃ©s de priÃ¨re"},
          {time:"Dhuhr", action:"PriÃ¨re + petite sieste"},
          {time:"â€˜Asr â€“ Maghrib", action:"Travail/savoir + sport"},
          {time:"Maghrib â€“ â€˜Isha", action:"Temps familial + Coran"},
          {time:"â€˜Isha", action:"PriÃ¨re + lecture/repos"},
          {time:"Nuit", action:"Coucher tÃ´t + QiyÃ¢m"}
        ],
        progress:(done,total)=>`Progression du jour : ${done}/${total} (${Math.round(done*100/total)}%)`
      },
      en:{
        title:"ğŸ•°ï¸ Time Management (Prophetic Way)",
        lang:"Language:",
        notify:"ğŸ”” Enable notifications",
        checkAll:"âœ… Check all",
        uncheckAll:"â†©ï¸ Uncheck all",
        resetDay:"ğŸ—“ï¸ Reset today",
        hint:"Tip: your progress is saved locally per day. Changing language also flips layout and texts.",
        notified:"âœ… Notifications enabled",
        noNotif:"ğŸš« Your browser does not support Notifications",
        tasks:[
          {time:"Before Fajr", action:"Qiyam (night prayer) & remembrance"},
          {time:"Fajr â€“ Sunrise", action:"Fajr prayer + Qurâ€™an & adhkar"},
          {time:"Morning", action:"Work/Study with sincere intention"},
          {time:"Duha", action:"2â€“4 units of prayer"},
          {time:"Dhuhr", action:"Prayer + short nap"},
          {time:"Asr â€“ Maghrib", action:"Work/Knowledge + Exercise"},
          {time:"Maghrib â€“ Isha", action:"Family time + Qurâ€™an"},
          {time:"Isha", action:"Prayer + Reading/Rest"},
          {time:"Night", action:"Sleep early + Qiyam"}
        ],
        progress:(done,total)=>`Todayâ€™s progress: ${done}/${total} (${Math.round(done*100/total)}%)`
      }
    };

    // ======= Elements =======
    const $ = sel => document.querySelector(sel);
    const tasksEl = $("#tasks");
    const titleEl = $("#title");
    const hintEl = $("#hint");
    const notifyBtn = $("#notifyBtn");
    const langSel = $("#lang");
    const checkAllBtn = $("#checkAll");
    const uncheckAllBtn = $("#uncheckAll");
    const resetDayBtn = $("#resetDay");
    const progressEl = $("#progress");

    // ======= State / storage keys =======
    const todayKey = () => new Date().toISOString().slice(0,10); // YYYY-MM-DD
    const lsKey = (lang) => `done_${todayKey()}_${lang}`;
    const langKey = "pref_lang";

    // ======= Render =======
    function render(lang){
      // direction & lang attr
      const rtl = (lang === "ar");
      document.documentElement.lang = lang;
      document.documentElement.dir = rtl ? "rtl" : "ltr";
      document.body.style.direction = rtl ? "rtl" : "ltr";

      const L = T[lang];
      titleEl.textContent = L.title;
      $("#langLabel").textContent = L.lang;
      notifyBtn.textContent = L.notify;
      checkAllBtn.textContent = L.checkAll;
      uncheckAllBtn.textContent = L.uncheckAll;
      resetDayBtn.textContent = L.resetDay;
      hintEl.textContent = L.hint;

      // load saved done map
      const saved = JSON.parse(localStorage.getItem(lsKey(lang)) || "{}");

      // build tasks
      tasksEl.innerHTML = "";
      L.tasks.forEach((t, i) => {
        const row = document.createElement("div");
        row.className = "task";
        row.innerHTML = `
          <div class="left">
            <input type="checkbox" id="chk-${i}" ${saved[i] ? "checked" : ""} />
            <span class="time">${t.time}</span>
            <span id="txt-${i}" class="${saved[i] ? "done" : ""}">${t.action}</span>
          </div>
          <div></div>
        `;
        tasksEl.appendChild(row);
      });

      // attach listeners to checkboxes
      L.tasks.forEach((_, i) => {
        $("#chk-"+i).addEventListener("change", e => {
          const map = JSON.parse(localStorage.getItem(lsKey(lang)) || "{}");
          const checked = e.target.checked;
          map[i] = checked;
          localStorage.setItem(lsKey(lang), JSON.stringify(map));
          $("#txt-"+i).classList.toggle("done", checked);
          updateProgress(lang);
        });
      });

      updateProgress(lang);
    }

    function updateProgress(lang){
      const L = T[lang];
      const map = JSON.parse(localStorage.getItem(lsKey(lang)) || "{}");
      const total = L.tasks.length;
      const done = Object.values(map).filter(Boolean).length;
      progressEl.textContent = L.progress(done, total);
    }

    // ======= Actions =======
    function enableNotifications(lang){
      const L = T[lang];
      if(!("Notification" in window)){
        alert(L.noNotif); return;
      }
      if(Notification.permission === "granted"){
        new Notification(L.notified);
      }else if(Notification.permission !== "denied"){
        Notification.requestPermission().then(p=>{
          if(p==="granted") new Notification(L.notified);
        });
      }
    }

    function checkAll(lang, value){
      const L = T[lang];
      const map = {};
      L.tasks.forEach((_, i)=>{
        const chk = $("#chk-"+i);
        const txt = $("#txt-"+i);
        chk.checked = value;
        txt.classList.toggle("done", value);
        map[i] = value;
      });
      localStorage.setItem(lsKey(lang), JSON.stringify(map));
      updateProgress(lang);
    }

    function resetToday(lang){
      localStorage.removeItem(lsKey(lang));
      render(lang);
    }

    // ======= Init =======
    document.addEventListener("DOMContentLoaded", ()=>{
      const initialLang = localStorage.getItem(langKey) || "ar";
      langSel.value = initialLang;
      render(initialLang);

      langSel.addEventListener("change", ()=>{
        const lang = langSel.value;
        localStorage.setItem(langKey, lang);
        render(lang);
      });

      notifyBtn.addEventListener("click", ()=> enableNotifications(langSel.value));
      checkAllBtn.addEventListener("click", ()=> checkAll(langSel.value, true));
      uncheckAllBtn.addEventListener("click", ()=> checkAll(langSel.value, false));
      resetDayBtn.addEventListener("click", ()=> resetToday(langSel.value));
    });
  </script>
</body>
</html>
